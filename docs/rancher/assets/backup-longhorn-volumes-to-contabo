# Backing Up Longhorn Volumes to Contabo

## 1. Collect Your Contabo S3 Credentials

Before starting, ensure you have the following details:

- Contabo S3 access key (`AWS_ACCESS_KEY_ID`)
- Contabo S3 secret key (`AWS_SECRET_ACCESS_KEY`)

These credentials are essential for the backup process, allowing Longhorn to access your Contabo S3 storage.

## 2. Create a Kubernetes Secret

This secret holds your Contabo S3 credentials, granting Longhorn the ability to authenticate with Contabo's S3 service. Execute the command below in your terminal, substituting `<your_access_key>` and `<your_secret_key>` with your actual Contabo S3 credentials:

```bash
kubectl create secret generic contabo-s3-secrets-for-longhorn \
  --from-literal=AWS_ACCESS_KEY_ID=<your_access_key> \
  --from-literal=AWS_SECRET_ACCESS_KEY=<your_secret_key> \
  --from-literal=AWS_ENDPOINT=https://eu2.contabostorage.com \
  --from-literal=AWS_REGION=default \
  --from-literal=VIRTUAL_HOSTED_STYLE=true
```

## 3. Set the Backup Target in Longhorn

1. Navigate to Longhorn's settings

    ![Backup Destination Configuration](./images/backup-destination-configuration.png)

2. Scroll down to the section about backup. You will now fill in the details

    ![Set the Backup Target in Longhorn](./images/set-the-backup-target-in-longhorn.png)

    - For `backupTarget`, input `s3://<bucket-name>@default/`, replacing `<bucket-name>` with your S3 bucket's name.
    - Use `contabo-s3-secrets-for-longhorn` for `backupTargetCredentialSecret`, referring to the secret created in the previous step.
