apiVersion: skaffold/v2beta9
kind: Config
build:
  local:
    push: false
  artifacts:
    - image: murmurations/index
      context: .
      docker:
        dockerfile: services/index/docker/Dockerfile-dev
    - image: murmurations/validation
      context: .
      docker:
        dockerfile: services/validation/docker/Dockerfile-dev
    - image: murmurations/cronjob
      context: .
      docker:
        dockerfile: services/cronjob/docker/Dockerfile-dev
deploy:
  helm:
    releases:
    - name: development
      chartPath: charts/murmurations
      artifactOverrides:
        indexServiceImage: murmurations/index
        validationServiceImage: murmurations/validation
        cronjobImage: murmurations/cronjob
      # Skaffold will try to parse the value part of each key-value pair using environment variables in the system
      setValueTemplates:
        sourcepath: "{{.SOURCEPATH}}"
